<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Giỏ Hàng - Hannie Book</title>
  <th:block th:replace="~{layout::link-css}"></th:block>
  <th:block th:replace="~{layout::custom-css}"></th:block>
</head>

<body>
  <th:block th:replace="~{layout::header}"></th:block>

  <div class="container mt-4">
    <h1 class="gradient-text mb-4 text-center">Giỏ Hàng Của Bạn</h1>

    <div th:if="${not #lists.isEmpty(cart.cartItems)}">
      <div class="card shadow-sm mb-4">
        <div class="table-responsive">
          <table class="table table-hover align-middle mb-0">
            <thead class="table-light">
              <tr>
                <th scope="col" class="ps-4">ID Sách</th>
                <th scope="col">Tên Sách</th>
                <th scope="col" style="width: 151px;">Số lượng</th>
                <th scope="col">Đơn giá</th>
                <th scope="col">Thành tiền</th>
                <th scope="col" class="text-center">Hành động</th>
              </tr>
            </thead>
            <tbody>
              <tr th:each="item : ${cart.cartItems}">
                <td class="ps-4" th:text="${item.getBookId()}"></td>
                <td class="fw-bold" th:text="${item.getBookName()}"></td>
                <td>
                  <div class="input-group input-group-sm">
                    <button class="btn btn-outline-secondary" type="button" onclick="updateQuantity(this, -1)"
                      th:attr="data-id=${item.getBookId()}"><i class="bi bi-dash"></i></button>
                    <input type="number" min="1" th:value="${item.getQuantity()}" th:attr="data-id=${item.getBookId()}"
                      class="form-control text-center quantity" readonly />
                    <button class="btn btn-outline-secondary" type="button" onclick="updateQuantity(this, 1)"
                      th:attr="data-id=${item.getBookId()}"><i class="bi bi-plus"></i></button>
                  </div>
                </td>
                <td th:text="${item.getPrice() + ' VNĐ'}"></td>
                <td class="fw-bold text-primary" th:text="${(item.getPrice() * item.getQuantity()) + ' VNĐ'}"></td>
                <td class="text-center">
                  <a class="btn btn-sm btn-outline-danger" title="Xóa"
                    th:href="@{/cart/removeFromCart/{id}(id=${item.getBookId()})}">
                    <i class="bi bi-trash"></i>
                  </a>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="row align-items-center">
        <div class="col-md-6 mb-3 mb-md-0">
          <h3 class="mb-0">Tổng cộng: <span class="text-primary" th:text="${totalPrice + ' VNĐ'}"></span></h3>
        </div>
        <div class="col-md-6 text-md-end">
          <a class="btn btn-outline-danger me-2" th:href="@{/cart/clearCart}"><i class="bi bi-trash-fill me-1"></i>Xóa
            sạch</a>
          <a class="btn btn-success px-4 shadow-sm" th:href="@{/cart/checkout}"><i
              class="bi bi-credit-card me-1"></i>Thanh toán</a>
        </div>
      </div>
    </div>

    <div th:if="${#lists.isEmpty(cart.cartItems)}" class="text-center py-5">
      <div class="mb-4 text-muted" style="font-size: 4rem;"><i class="bi bi-cart-x"></i></div>
      <h3>Giỏ hàng của bạn đang trống</h3>
      <p class="text-muted mb-4">Hãy chọn những cuốn sách yêu thích của bạn và thêm vào giỏ hàng nhé!</p>
      <a class="btn btn-primary px-4 shadow-sm" href="/books"><i class="bi bi-arrow-right me-1"></i>Tiếp tục mua sắm</a>
    </div>
  </div>

  <th:block th:replace="~{layout::footer}"></th:block>
  <script th:src="@{/js/cart.js}"></script>
</body>

</html>