<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Thanh Toán QR - Hannie Book</title>
    <th:block th:replace="~{layout::link-css}"></th:block>
    <th:block th:replace="~{layout::custom-css}"></th:block>
</head>

<body>
    <th:block th:replace="~{layout::header}"></th:block>

    <div class="container py-5 animate-fade-in">
        <div class="row justify-content-center">
            <div class="col-md-5">
                <div class="text-center mb-4">
                    <div class="display-1 text-success mb-2">
                        <i class="bi bi-check-circle-fill"></i>
                    </div>
                    <h2 class="fw-bold gradient-text">Đặt Hàng Thành Công!</h2>
                    <p class="text-muted">Cảm ơn bạn đã mua sắm tại Hannie Book</p>
                </div>

                <div class="glass-card p-0 overflow-hidden shadow-lg border-0 mb-4">
                    <div class="bg-primary p-4 text-center text-white position-relative overflow-hidden">
                        <div class="position-absolute top-0 start-0 w-100 h-100"
                            style="background: linear-gradient(45deg, rgba(255,255,255,0.1), transparent); pointer-events: none;">
                        </div>
                        <h5 class="mb-1 fw-bold text-white">Thanh Toán QR Code</h5>
                        <p class="mb-0 small opacity-75">Quét mã để hoàn tất thanh toán</p>
                    </div>

                    <div class="p-4 text-center bg-white">
                        <div class="qr-wrapper p-2 bg-white rounded shadow-sm d-inline-block border mb-3">
                            <img th:src="@{'https://img.vietqr.io/image/MB-0858581488-compact2.png?amount=' + ${invoice.price.intValue()} + '&addInfo=Thanh%20Toan%20Don%20Hang%20' + ${invoice.id} + '&accountName=NGO%20BICH%20HANG'}"
                                alt="QR Code" class="img-fluid" style="width: 200px; height: 200px;">
                        </div>

                        <div class="payment-details mt-2">
                            <div class="d-flex justify-content-between py-2 border-bottom">
                                <span class="text-muted small">Mã đơn hàng</span>
                                <span class="fw-bold text-dark" th:text="'#' + ${orderId}"></span>
                            </div>
                            <div class="d-flex justify-content-between py-2 border-bottom">
                                <span class="text-muted small">Tổng thanh toán</span>
                                <span class="fw-bold text-primary fs-5"
                                    th:text="${#numbers.formatInteger(invoice.price,3,'POINT')} + ' VNĐ'"></span>
                            </div>
                            <div class="d-flex justify-content-between py-2 pt-3">
                                <span class="text-muted small">Ngân hàng</span>
                                <span class="fw-bold text-dark">MB Bank</span>
                            </div>
                            <div class="d-flex justify-content-between py-1">
                                <span class="text-muted small">Số tài khoản</span>
                                <span class="fw-bold text-dark copy-text" role="button"
                                    onclick="copyToClipboard('0858581488')" title="Sao chép">
                                    0858581488 <i class="bi bi-clipboard ms-1 text-muted small"></i>
                                </span>
                            </div>
                            <div class="d-flex justify-content-between py-1">
                                <span class="text-muted small">Chủ tài khoản</span>
                                <span class="fw-bold text-dark">NGO BICH HANG</span>
                            </div>
                        </div>
                    </div>

                    <div class="p-3 bg-light border-top text-center">
                        <div class="alert alert-warning border-0 bg-warning bg-opacity-10 py-2 small mb-3">
                            <i class="bi bi-info-circle me-1"></i> Nội dung CK: <strong>Thanh Toan Don Hang <span
                                    th:text="${orderId}"></span></strong>
                        </div>

                        <a th:href="@{/orders/{id}(id=${orderId})}" class="btn btn-outline-primary w-100 mb-2">
                            <i class="bi bi-cloud-upload me-1"></i> Tải lên minh chứng
                        </a>
                        <a href="/" class="btn btn-link text-decoration-none text-muted small">
                            <i class="bi bi-arrow-left me-1"></i>Về trang chủ
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast for copy notification -->
    <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
        <div id="copyToast" class="toast align-items-center text-white bg-success border-0" role="alert"
            aria-live="assertive" aria-atomic="true">
            <div class="d-flex">
                <div class="toast-body">
                    Đã sao chép số tài khoản!
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"
                    aria-label="Close"></button>
            </div>
        </div>
    </div>

    <script>
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(function () {
                var toastEl = document.getElementById('copyToast');
                var toast = new bootstrap.Toast(toastEl);
                toast.show();
            }, function (err) {
                console.error('Không thể sao chép: ', err);
            });
        }
    </script>

    <th:block th:replace="~{layout::footer}"></th:block>
</body>

</html>